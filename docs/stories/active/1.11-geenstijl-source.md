# Story 1.11 â€“ GeenStijl als nieuwsbron

## Overzicht

| Veld         | Waarde                                    |
|--------------|-------------------------------------------|
| Story ID     | 1.11                                      |
| Titel        | GeenStijl als nieuwsbron toevoegen        |
| Epic         | 1 â€“ Multi-Source Ingestion                |
| Status       | ðŸ”² Ready                                  |
| Geschat      | S (klein)                                 |
| Prerequisite | Story 1.1 (RSS Ingestion), Story 1.4 (NU.nl full-text) |

---

## Doel

GeenStijl.nl toevoegen als nieuwsbron om een opiniÃ«rende, rechtse stem in het pluralistische nieuws-overzicht te brengen. GeenStijl biedt een duidelijk afwijkend perspectief ten opzichte van de gevestigde media in het systeem, wat bijdraagt aan het doel van de 360Â° News Aggregator.

---

## Context & Onderzoek

### Feed Details

| Eigenschap     | Waarde                                          |
|----------------|-------------------------------------------------|
| Feed URL       | `https://www.geenstijl.nl/feeds/recent.atom`    |
| Feed Type      | Atom                                            |
| Encoding       | UTF-8                                           |
| Update Freq    | Meerdere posts per dag                          |
| Full Content   | Nee â€“ alleen titel en samenvatting in feed      |

### Content Kenmerken

- **Stijl**: OpiniÃ«rend, satirisch, provocerend
- **Onderwerpen**: Politiek, maatschappij, media-kritiek, sport
- **Toon**: Informeel, vaak met woordspelingen en neologismen
- **Relevantie**: Biedt tegenwicht aan mainstream media-perspectief

### Technische Observaties

- Website draait op Next.js (moderne stack)
- Atom feed met standaard structuur: `<entry>`, `<title>`, `<link>`, `<summary>`
- Artikel-URLs volgen patroon: `https://www.geenstijl.nl/[category]/[slug]`
- Mogelijk Cloudflare bescherming â€“ testen met Playwright nodig
- Geen paywalls

---

## Acceptatiecriteria

- [ ] **AC-1**: GeenStijl Atom feed wordt succesvol geparsed en artikelen worden opgeslagen
- [ ] **AC-2**: Full-text content wordt opgehaald via Playwright (inclusief consent handling indien nodig)
- [ ] **AC-3**: Artikelen worden correct geclusterd met gerelateerde events van andere bronnen
- [ ] **AC-4**: Source profile toegevoegd aan `source_profiles.yaml`
- [ ] **AC-5**: Tenminste 3 GeenStijl artikelen zichtbaar in frontend na poll cyclus

---

## Subtaken

### 1. Feed Configuratie
- [ ] Voeg feed entry toe aan `backend/app/core/config.py`:
  ```python
  {
      "name": "GeenStijl",
      "url": "https://www.geenstijl.nl/feeds/recent.atom",
      "feed_type": "atom",
      "requires_playwright": True
  }
  ```

### 2. Playwright Scraper
- [ ] Maak `backend/app/feeds/geenstijl.py` met GeenStijl-specifieke parser
- [ ] Implementeer content extractie (artikeltekst exclusief comments/sidebar)
- [ ] Handle eventuele cookie consent banner
- [ ] Test met minimaal 5 verschillende artikel-URLs

### 3. Source Profile
- [ ] Voeg GeenStijl profiel toe aan `source_profiles.yaml`:
  ```yaml
  geenstijl:
    name: "GeenStijl"
    bias_label: "right-leaning"
    style: "opinion/satirical"
    description: "OpiniÃ«rend platform met rechtse, libertarische inslag"
    credibility_notes: "Sterke meningen, fact-checking varieert"
  ```

### 4. Integratie Testen
- [ ] Voer handmatige poll uit: `curl -X POST "http://localhost:8000/admin/trigger/poll-feeds"`
- [ ] Verifieer artikelen in database met correcte source_name
- [ ] Controleer of artikelen clusteren met events van andere bronnen
- [ ] Bekijk frontend om GeenStijl artikelen in event cards te zien

### 5. Edge Cases
- [ ] Test artikel met veel embedded media (YouTube, tweets)
- [ ] Test artikel met alleen tekst (klassiek format)
- [ ] Verifieer dat satirische koppen niet clustering verstoren

---

## Technische Notities

### Content Selector Hints (te verifiÃ«ren)

```python
# Verwachte selectors (testen nodig)
ARTICLE_SELECTORS = [
    "article .prose",       # Next.js prose container
    "article .content",     # Alternatief
    ".article-body",        # Fallback
]

# Te verwijderen elementen
REMOVE_SELECTORS = [
    ".comments",
    ".sidebar",
    ".related-posts",
    "script",
    "style",
]
```

### Atom Feed Structuur

```xml
<entry>
  <title>Artikeltitel hier</title>
  <link href="https://www.geenstijl.nl/category/artikel-slug"/>
  <id>unieke-id</id>
  <updated>2025-12-06T23:01:43.688+01:00</updated>
  <summary type="html">Korte samenvatting...</summary>
  <author><name>Auteursnaam</name></author>
</entry>
```

---

## Risico's & Mitigatie

| Risico | Impact | Mitigatie |
|--------|--------|-----------|
| Cloudflare blocking | Hoog | Playwright met realistic headers, rate limiting |
| Layout wijziging | Medium | Robuuste CSS selectors met fallbacks |
| Satirische content verstoort clustering | Laag | LLM-based event matching moet hier mee omgaan |

---

## Definition of Done

- [ ] Alle acceptatiecriteria voldaan
- [ ] Code volgt bestaande patterns (zie `backend/app/feeds/*.py`)
- [ ] Geen nieuwe linting errors (`make lint`)
- [ ] Backend start zonder errors
- [ ] Handmatige verificatie: GeenStijl artikelen verschijnen in UI

---

## Story Wrap-Up

*(In te vullen na voltooiing)*

| Metric            | Waarde |
|-------------------|--------|
| Voltooid op       |        |
| Artikelen getest  |        |
| Issues gevonden   |        |
| Notities          |        |
